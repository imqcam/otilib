package:
  name: pyoti
  version: "1.0.0"

source:
  # git_rev: v1.0.0
  # git_url: https://github.com/imqcam/otilib
  path: ..

build:
  number: 0
  script: |
    mkdir build
    cd build
    cmake ..
    {% if conda_build.is_windows %}
    cmake --build . --config Release
    cmake --build . --target gendata
    if exist pyoti %SP_DIR%\pyoti
    if exist data %SP_DIR\data
    {% else %}
    make
    make gendata
    cp -r pyoti $SP_DIR/pyoti
    cp -r data $SP_DIR/data
    {% endif %}

requirements:
  build:
    - python=3.9.*
    - numpy
    - scipy
    - pandas
    - cython=0.29.*
    - make [unix]
    - cmake
    - gfortran [unix]
    - pip
    - ipykernel
    - conda-forge::pyvista
    - conda-forge::gmsh
    - conda-forge::python-gmsh
    - conda-forge::vtk
    - conda-forge::scikit-sparse
    - conda-forge::scikit-umfpack [unix]

  host:
    - python=3.9.*
    - numpy
    - scipy
    - pandas
    - cython=0.29.*
    - make [unix]
    - cmake
    - gfortran [unix]
    - pip
    - ipykernel
    - conda-forge::pyvista
    - conda-forge::gmsh
    - conda-forge::python-gmsh
    - conda-forge::vtk
    - conda-forge::scikit-sparse
    - conda-forge::scikit-umfpack [unix]

  run:
    - python=3.9.*
    - numpy
    - scipy
    - pandas
    - cython=0.29.*
    - conda-forge::pyvista
    - conda-forge::gmsh
    - conda-forge::python-gmsh
    - conda-forge::vtk
    - conda-forge::scikit-sparse
    - conda-forge::scikit-umfpack [unix]

test:
  imports:
    - pyoti
  commands:
    - python -c "import pyoti"

about:
  home: imqcam/otilib

channels:
  - conda-forge
  - defaults
