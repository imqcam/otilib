

















# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::     CLASS  elBase    ::::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
cdef class elBase:
  
  #---------------------------------------------------------------------------------------------------
  #------------------------------------   DEFINITION OF ATTRIBUTES   ---------------------------------
  #---------------------------------------------------------------------------------------------------



  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  def __init__(self):
    """
    PURPOSE:      Constructor of the base element class. Its main purpose is to 
                  allow a base for every new element definition.


    """
    
    self.a = 1

  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  def __dealloc__(self):
    """

    PURPOSE:      Destructor of the base element class. 


    """
    # print("trying Dealloc elBase")
    if self.elem.isInit:
      elem_free(&self.elem)
    # end if 
    # print("finished Dealloc elBase")

  #---------------------------------------------------------------------------------------------------
  
  #***************************************************************************************************
  @staticmethod
  cdef elBase createNewElement(uint64_t nbasis, uint64_t order, int64_t geomBase, \
                               int64_t  kind,   uint8_t  ndim, \
              int64_t (*basis_f)(int64_t,int64_t,darr_t*,void*,darr_t*) nogil, list boundEls ):
    """
    PURPOSE:      C-level constructor of the Element class. Use this when adding new element types.

    DESCRIPTION:  Creates and associates an element that can be called from the Problem class.

    PARAMETERS:

      -> nbasis:   Number of basis - Number of degrees of freedom - Number of nodes.

      -> order:    Maximum order of the element.

      -> geomBase: Geometric element type - elLine, elTriangle, etc ...

      -> kind:     Kind of element: Affine - IsoParametric

      -> ndim:     Number of dimensions of the element. (1 -> 1D, 2 -> 2D, 3 -> 3D)

      -> basis_f:  Interpolation function.

      -> boundEls: List of the already defined interpolation functions that define the boundary 
                   interpolation, in the following order.  --> [0D, 1D, 2D]

    RESULT:       
            A new elBase object is created.

    EXAMPLE:

            TriP1 = elBase.createNewElement(3,           \ # Number of basis 
                                            1,           \ # Characteristic order of the polynomials
                                            elTriangle,  \ # Geometric type
                                            elkindiso,   \ # Kind of element 
                                            2,           \ # Number of dimensions
                                            &c_fem_basisFunctions_N_TriangP1_2Diso) # Basis functions.

                  
    """
    #*************************************************************************************************

    # create new empty object:
    cdef elBase newElement = <elBase> elBase.__new__(elBase)

    newElement.elem = elem_init()
    
    elem_allocate( &newElement.elem, nbasis, order, geomBase, kind, ndim, basis_f)

    return newElement
  #---------------------------------------------------------------------------------------------------

  # #***************************************************************************************************
  # cpdef initElement(self, uint64_t order, uint8_t otiorder, uint8_t nDimAnalysis):

  #   c_fem_initElement( order, otiorder, nDimAnalysis,&self.elemProps)


  # #---------------------------------------------------------------------------------------------------

  # #***************************************************************************************************
  # cpdef uninitElement(self):
  #   if self.elemProps.isInit == 1:
  #     c_fem_unInitElement(&self.elemProps)
  #   # end if 

  # #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  @property
  def intWts(self):
    """
    PURPOSE:      Get self.elemProps.intWeights

    """
    #*************************************************************************************************

    return  dmat.create(&self.elem.intWts,FLAGS=0)

  #---------------------------------------------------------------------------------------------------


  #***************************************************************************************************
  @property
  def intPts(self):
    """
    PURPOSE:      Get self.elemProps.intPoints

    """
    #*************************************************************************************************

    return dmat.create(&self.elem.intPts,FLAGS=0)

  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  @property
  def nIntPts(self):
    """
    PURPOSE:      Get self.elemProps.nIntPts

    """
    #*************************************************************************************************

    return self.elem.nIntPts

  #---------------------------------------------------------------------------------------------------


  #***************************************************************************************************
  @property
  def nder(self):
    """
    PURPOSE:      Get self.elemProps.nder

    """
    #*************************************************************************************************

    return self.elem.nder

  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  @property
  def nIntPts(self):
    """
    PURPOSE:      Get self.elemProps.nIntPts

    """
    #*************************************************************************************************

    return self.elem.nIntPts

  #---------------------------------------------------------------------------------------------------



  #***************************************************************************************************
  @property
  def isInit(self):
    """
    PURPOSE:      Get self.elemProps.isInit

    """
    #*************************************************************************************************
    
    return self.elem.isInit

  #---------------------------------------------------------------------------------------------------



  #***************************************************************************************************
  @property
  def nbasis(self):
    """
    PURPOSE:      Get self.elemProps.nbasis

    """
    #*************************************************************************************************

    return self.elem.nbasis

  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  @property
  def order(self):
    """
    PURPOSE:      Get self.elemProps.order

    """
    #*************************************************************************************************

    return self.elem.order

  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  @property
  def geomBase(self):
    """
    PURPOSE:      Get self.elemProps.geomBase

    """
    #*************************************************************************************************

    return self.elem.geomBase

  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  @property
  def kind(self):
    """
    PURPOSE:      Get self.elemProps.kind

    """
    #*************************************************************************************************

    return self.elem.kind

  #---------------------------------------------------------------------------------------------------

  #***************************************************************************************************
  @property
  def ndim(self):
    """
    PURPOSE:      Get self.elemProps.ndim

    """
    #*************************************************************************************************

    return self.elem.ndim

  #---------------------------------------------------------------------------------------------------

  # #***************************************************************************************************
  # cdef sndarray Ke(self,sndarray coords, np.ndarray connect, other):
  #   """
  #   PURPOSE:      Given the nodal coordinates, etc, calculate the elemental stiffness matrix for this
  #                 problem.
                  
  #   """
  #   cdef sndarray res = spzeros((1,1))
  #   return res
  # #---------------------------------------------------------------------------------------------------

  # #***************************************************************************************************
  # cdef sndarray fe(self,sndarray coords, np.ndarray connect, other):
  #   """
  #   PURPOSE:      Given the nodal coordinates, etc, calculate the elemental force vector a 
  #                 problem.
                  
  #   """
    


  #   cdef sndarray res = spzeros((1,1))
  #   return res
  # #---------------------------------------------------------------------------------------------------



# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# :::::::::::::::::::::::::::::::::::: END OF CLASS elBase :::::::::::::::::::::::::::::::::::::::::::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


























