


border a0(t= 1,   0){    x=-2;       y=t;    label=0;}
border a1(t= -2,  0){    x=t;        y=0;    label=1;}
border a2(t= 0,-0.5){    x=0;        y=t;    label=2;}
border a3(t= 0,   1){    x=18*t^1.2; y=-0.5; label=3;}
border a4(t= -0.5,1){    x=18;       y=t;    label=4;}
border a5(t= 1,   0){    x=-2+20*t;  y=1;    label=5;}

int n=1;

mesh Th= buildmesh( a0(3*n)+a1(20*n)+a2(10*n)+a3(150*n)+a4(5*n)+a5(100*n) );
//mesh Th=square(10,10);

//cout<<Th.nv<<endl;

plot(Th);


fespace Uh(Th,P2); 
Uh ux, uy, vx, vy;
cout<<ux[]<<endl;
fespace Ph(Th,P1); 
Ph p,q;



solve stokes([ux,uy,p],[vx,vy,q]) = 
    int2d(Th)( dx(ux)*dx(vx) + dy(ux)*dy(vx)  ) + 
    int2d(Th)( dx(uy)*dx(vy) + dy(uy)*dy(vy)  ) + 
    int2d(Th)( dx(p)*vx      + dy(p)*vy       ) + 
    int2d(Th)( dx(ux)*q      + dy(uy)*q       ) + 
    int2d(Th)( (-1e-10)*p*q                   ) + 
    //on(4, ux =   4*y*(1-y) ) + on(4, uy =  0  ) +
    //on(1,3,ux = 0) + on(1,3,uy = 0)  ;
    on(0, ux =   4*y*(1-y) ) + on(0, uy =  0  ) +
    on(1,2,3,5,ux = 0) + on(1,2,3,5,uy = 0)  ;


cout<<p[].max-p[].min<<endl;

plot(Th,ux,wait=1);
plot(Th,uy,wait=1);
plot(Th,p ,wait=1);
plot([ux,uy],wait=1);