#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Use of multiduals alternate form to compute multiple high order derivatives
\end_layout

\begin_layout Standard
The goal of this document is to show an alternate manner to compute all
 second order derivatives of a multivariable function.
 The alternate solution requires less number of evaluations compared with
 traditional multidual perturbation schemes.
 In contrast to traditional multidual evaluations, a small step size 
\begin_inset Formula $h$
\end_inset

 is required.
\end_layout

\begin_layout Section
Case study: Three variable function.
\end_layout

\begin_layout Standard
Consider the three variable function 
\begin_inset Formula $f:\mathbb{R}^{3}\rightarrow\mathbb{R}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
f(x,y,z)=\sin(xyz)\label{eq:function}
\end{equation}

\end_inset

the goal is to compute all second order derivatives of the function with
 respect to 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $y$
\end_inset

 and 
\series bold

\begin_inset Formula $z$
\end_inset

.
\end_layout

\begin_layout Subsection
Traditional multidual evaluation.
\end_layout

\begin_layout Standard
To compute all second order derivatives, 6 bidual evaluations are required;
 namely
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
f(x+h\epsilon_{1}+h\epsilon_{2},y\phantom{+h\epsilon_{3}}\phantom{+h\epsilon_{3}},z) & , & f(x+h\epsilon_{1},y\phantom{+h\epsilon_{3}},z+h\epsilon_{2}\phantom{+h\epsilon_{3}})\\
f(x+h\epsilon_{1}\phantom{+h\epsilon_{3}},y+h\epsilon_{2}\phantom{+h\epsilon_{3}},z) & , & f(x\phantom{+h\epsilon_{3}},y+h\epsilon_{1},z+h\epsilon_{2}\phantom{+h\epsilon_{3}})\\
f(x\phantom{+h\epsilon_{3}}\phantom{+h\epsilon_{3}},y+h\epsilon_{1}+h\epsilon_{2},z) & , & f(x\phantom{+h\epsilon_{3}},y\phantom{+h\epsilon_{3}},z+h\epsilon_{1}+h\epsilon_{2})
\end{eqnarray*}

\end_inset

alternatively, 3 tridual evaluations can be performed to obtain all second
 order derivatives,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
f(x+h\epsilon_{1}+h\epsilon_{2},y+h\epsilon_{3}\phantom{+h\epsilon_{3}},z\phantom{+h\epsilon_{1}}) & , & f(x+h\epsilon_{1},y,z+h\epsilon_{2}+h\epsilon_{3})\\
f(x\phantom{+h\epsilon_{1}}\phantom{+h\epsilon_{3}},y+h\epsilon_{1}+h\epsilon_{2},z+h\epsilon_{3})
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Alternate multidual evaluation.
\end_layout

\begin_layout Standard
If we follow the following pertubration using triduals, we can obtain all
 second order derivatives in 3 analyses instead of 6.
 We need to add a perturbation in the mixed direction as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
 & f(x+\underline{h\epsilon_{1}+h\epsilon_{3}},y+h\epsilon_{2}\phantom{+h\epsilon_{3}},z+\underline{h\epsilon_{12}}\phantom{+h\epsilon_{3}})\label{eq:eval1}\\
 & f(x+h\epsilon_{1}\phantom{+h\epsilon_{3}},y+\underline{h\epsilon_{2}+h\epsilon_{3}},z+\underline{h\epsilon_{12}}\phantom{+h\epsilon_{3}})\label{eq:eval2}\\
 & f(x+h\epsilon_{1}\phantom{+h\epsilon_{3}},y+h\epsilon_{2}\phantom{+h\epsilon_{3}},z+\underline{h\epsilon_{12}+h\epsilon_{3}})\label{eq:eval3}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
From evaluation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:eval1"

\end_inset

, we can extract 3 second order derivatives as follows (The 
\series bold
new
\series default
 derivatives are shown underlined):
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\underline{f_{,xx}} & \approx & \text{Im}_{\epsilon_{13}}[f(x+h\epsilon_{1}+h\epsilon_{3},y+h\epsilon_{2},z+h\epsilon_{12})]/h^{2}\\
\underline{f_{,xy}} & \approx & \text{Im}_{\epsilon_{23}}[f(x+h\epsilon_{1}+h\epsilon_{3},y+h\epsilon_{2},z+h\epsilon_{12})]/h^{2}\\
\underline{f_{,xz}} & \approx & \text{Im}_{\epsilon_{123}}[f(x+h\epsilon_{1}+h\epsilon_{3},y+h\epsilon_{2},z+h\epsilon_{12})]/h^{2}
\end{eqnarray*}

\end_inset

from evaluation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:eval2"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we can extract
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
f_{,xy} & \approx & \text{Im}_{\epsilon_{13}}[f(x+h\epsilon_{1},y+h\epsilon_{2}+h\epsilon_{3},z+h\epsilon_{12})]/h^{2}\\
\underline{f_{,yy}} & \approx & \text{Im}_{\epsilon_{23}}[f(x+h\epsilon_{1},y+h\epsilon_{2}+h\epsilon_{3},z+h\epsilon_{12})]/h^{2}\\
\underline{f_{,yz}} & \approx & \text{Im}_{\epsilon_{123}}[f(x+h\epsilon_{1},y+h\epsilon_{2}+h\epsilon_{3},z+h\epsilon_{12})]/h^{2}
\end{eqnarray*}

\end_inset

and from evaluation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:eval3"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we extract
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
f_{,xz} & \approx & \text{Im}_{\epsilon_{13}}[f(x+h\epsilon_{1},y+h\epsilon_{2},z+h\epsilon_{12}+h\epsilon_{3})]/h^{2}\\
f_{,yz} & \approx & \text{Im}_{\epsilon_{23}}[f(x+h\epsilon_{1},y+h\epsilon_{2},z+h\epsilon_{12}+h\epsilon_{3})]/h^{2}\\
\underline{f_{,zz}} & \approx & \text{Im}_{\epsilon_{123}}[f(x+h\epsilon_{1},y+h\epsilon_{2},z+h\epsilon_{12}+h\epsilon_{3})]/h^{2}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Results are shown in the following figure applied to function 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:function"

\end_inset

, which shows linear convergence of some derivatives with respect to the
 step size, and shows that it is possible to evaluate 3 triduals to obatain
 all second order derivatives.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename tridual_more_efficient.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tridual analysis to compute all second order derivatives of tri-variable
 function.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_body
\end_document
