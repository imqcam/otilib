
// ****************************************************************************************************
void der_r_asin(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t x2 = pow(x0,2);
    derivs[0]=asin(x0);
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=pow(1.-x2,-0.5);
            case 2:
                derivs[2]=x0*pow(1.-x2,-1.5);
            case 3:
                derivs[3]=3.*x2*pow(1.-x2,-2.5)+pow(1.-x2,-1.5);
            case 4:
                derivs[4]=15.*pow(x0,3)*pow(1.-x2,-3.5)+9.*x0*pow(1.-x2,-2.5);
            case 5:
                derivs[5]=105.*pow(x0,4)*pow(1.-x2,-4.5)+90.*x2*pow(1.-x2,-3.5)+9.*pow(1.-x2,-2.5);
            case 6:
                derivs[6]=945.*pow(x0,5)*pow(1.-x2,-5.5)+1050.*pow(x0,3)*pow(1.-x2,-4.5)+225.*x0*pow(1.-x2,-3.5);
            case 7:
                derivs[7]=10395.*pow(x0,6)*pow(1.-x2,-6.5)+14175.*pow(x0,4)*pow(1.-x2,-5.5)+4725.*x2*pow(1.-x2,-4.5)+225.*pow(1.-x2,-3.5);
            case 8:
                derivs[8]=135135.*pow(x0,7)*pow(1.-x2,-7.5)+218295.*pow(x0,5)*pow(1.-x2,-6.5)+99225.*pow(x0,3)*pow(1.-x2,-5.5)+11025.*x0*pow(1.-x2,-4.5);
            case 9:
                derivs[9]=2027025.*pow(x0,8)*pow(1.-x2,-8.5)+3783780.*pow(x0,6)*pow(1.-x2,-7.5)+2182950.*pow(x0,4)*pow(1.-x2,-6.5)+396900.*x2*pow(1.-x2,-5.5)+11025.*pow(1.-x2,-4.5);
            case 10:
                derivs[10]=34459425.*pow(x0,9)*pow(1.-x2,-9.5)+72972900.*pow(x0,7)*pow(1.-x2,-8.5)+51081030.*pow(x0,5)*pow(1.-x2,-7.5)+13097700.*pow(x0,3)*pow(1.-x2,-6.5)+893025.*x0*pow(1.-x2,-5.5);
        }
    }
}
// ----------------------------------------------------------------------------------------------------

// ****************************************************************************************************
void der_r_acos(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t x2 = pow(x0,2);
    derivs[0]=acos(x0);
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=-pow(1.-x2,-0.5);
            case 2:
                derivs[2]=-x0*pow(1.-x2,-1.5);
            case 3:
                derivs[3]=-3.*x2*pow(1.-x2,-2.5)-pow(1.-x2,-1.5);
            case 4:
                derivs[4]=-15.*pow(x0,3)*pow(1.-x2,-3.5)-9.*x0*pow(1.-x2,-2.5);
            case 5:
                derivs[5]=-105.*pow(x0,4)*pow(1.-x2,-4.5)-90.*x2*pow(1.-x2,-3.5)-9.*pow(1.-x2,-2.5);
            case 6:
                derivs[6]=-945.*pow(x0,5)*pow(1.-x2,-5.5)-1050.*pow(x0,3)*pow(1.-x2,-4.5)-225.*x0*pow(1.-x2,-3.5);
            case 7:
                derivs[7]=-10395.*pow(x0,6)*pow(1.-x2,-6.5)-14175.*pow(x0,4)*pow(1.-x2,-5.5)-4725.*x2*pow(1.-x2,-4.5)-225.*pow(1.-x2,-3.5);
            case 8:
                derivs[8]=-135135.*pow(x0,7)*pow(1.-x2,-7.5)-218295.*pow(x0,5)*pow(1.-x2,-6.5)-99225.*pow(x0,3)*pow(1.-x2,-5.5)-11025.*x0*pow(1.-x2,-4.5);
            case 9:
                derivs[9]=-2027025.*pow(x0,8)*pow(1.-x2,-8.5)-3783780.*pow(x0,6)*pow(1.-x2,-7.5)-2182950.*pow(x0,4)*pow(1.-x2,-6.5)-396900.*x2*pow(1.-x2,-5.5)-11025.*pow(1.-x2,-4.5);
            case 10:
                derivs[10]=-34459425.*pow(x0,9)*pow(1.-x2,-9.5)-72972900.*pow(x0,7)*pow(1.-x2,-8.5)-51081030.*pow(x0,5)*pow(1.-x2,-7.5)-13097700.*pow(x0,3)*pow(1.-x2,-6.5)-893025.*x0*pow(1.-x2,-5.5);
        }
    }
}
// ----------------------------------------------------------------------------------------------------

// ****************************************************************************************************
void der_r_atan(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t x2 = pow(x0,2);
    derivs[0]=atan(x0);
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=1./(x2+1.);
            case 2:
                derivs[2]=-2.*x0/pow(x2+1.,2);
            case 3:
                derivs[3]=8.*x2/pow(x2+1.,3)-2./pow(x2+1.,2);
            case 4:
                derivs[4]=-48.*pow(x0,3)/pow(x2+1.,4)+24.*x0/pow(x2+1.,3);
            case 5:
                derivs[5]=384.*pow(x0,4)/pow(x2+1.,5)-288.*x2/pow(x2+1.,4)+24./pow(x2+1.,3);
            case 6:
                derivs[6]=-3840.*pow(x0,5)/pow(x2+1.,6)+3840.*pow(x0,3)/pow(x2+1.,5)-720.*x0/pow(x2+1.,4);
            case 7:
                derivs[7]=46080.*pow(x0,6)/pow(x2+1.,7)-57600.*pow(x0,4)/pow(x2+1.,6)+17280.*x2/pow(x2+1.,5)-720./pow(x2+1.,4);
            case 8:
                derivs[8]=-645120.*pow(x0,7)/pow(x2+1.,8)+967680.*pow(x0,5)/pow(x2+1.,7)-403200.*pow(x0,3)/pow(x2+1.,6)+40320.*x0/pow(x2+1.,5);
            case 9:
                derivs[9]=10321920.*pow(x0,8)/pow(x2+1.,9)-18063360.*pow(x0,6)/pow(x2+1.,8)+9676800.*pow(x0,4)/pow(x2+1.,7)-1612800.*x2/pow(x2+1.,6)+40320./pow(x2+1.,5);
            case 10:
                derivs[10]=-185794560.*pow(x0,9)/pow(x2+1.,10)+371589120.*pow(x0,7)/pow(x2+1.,9)-243855360.*pow(x0,5)/pow(x2+1.,8)+58060800.*pow(x0,3)/pow(x2+1.,7)-3628800.*x0/pow(x2+1.,6);
        }
    }
}
// ----------------------------------------------------------------------------------------------------

// ****************************************************************************************************
void der_r_asinh(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t x2 = pow(x0,2);
    derivs[0]=asinh(x0);
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=pow(x2+1.,-0.5);
            case 2:
                derivs[2]=-x0*pow(x2+1.,-1.5);
            case 3:
                derivs[3]=3.*x2*pow(x2+1.,-2.5)-pow(x2+1.,-1.5);
            case 4:
                derivs[4]=-15.*pow(x0,3)*pow(x2+1.,-3.5)+9.*x0*pow(x2+1.,-2.5);
            case 5:
                derivs[5]=105.*pow(x0,4)*pow(x2+1.,-4.5)-90.*x2*pow(x2+1.,-3.5)+9.*pow(x2+1.,-2.5);
            case 6:
                derivs[6]=-945.*pow(x0,5)*pow(x2+1.,-5.5)+1050.*pow(x0,3)*pow(x2+1.,-4.5)-225.*x0*pow(x2+1.,-3.5);
            case 7:
                derivs[7]=10395.*pow(x0,6)*pow(x2+1.,-6.5)-14175.*pow(x0,4)*pow(x2+1.,-5.5)+4725.*x2*pow(x2+1.,-4.5)-225.*pow(x2+1.,-3.5);
            case 8:
                derivs[8]=-135135.*pow(x0,7)*pow(x2+1.,-7.5)+218295.*pow(x0,5)*pow(x2+1.,-6.5)-99225.*pow(x0,3)*pow(x2+1.,-5.5)+11025.*x0*pow(x2+1.,-4.5);
            case 9:
                derivs[9]=2027025.*pow(x0,8)*pow(x2+1.,-8.5)-3783780.*pow(x0,6)*pow(x2+1.,-7.5)+2182950.*pow(x0,4)*pow(x2+1.,-6.5)-396900.*x2*pow(x2+1.,-5.5)+11025.*pow(x2+1.,-4.5);
            case 10:
                derivs[10]=-34459425.*pow(x0,9)*pow(x2+1.,-9.5)+72972900.*pow(x0,7)*pow(x2+1.,-8.5)-51081030.*pow(x0,5)*pow(x2+1.,-7.5)+13097700.*pow(x0,3)*pow(x2+1.,-6.5)-893025.*x0*pow(x2+1.,-5.5);
        }
    }
}
// ----------------------------------------------------------------------------------------------------

// ****************************************************************************************************
void der_r_acosh(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t x2 = pow(x0,2);
    derivs[0]=acosh(x0);
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=pow(x2-1.,-0.5);
            case 2:
                derivs[2]=-x0*pow(x2-1.,-1.5);
            case 3:
                derivs[3]=3.*x2*pow(x2-1.,-2.5)-pow(x2-1.,-1.5);
            case 4:
                derivs[4]=-15.*pow(x0,3)*pow(x2-1.,-3.5)+9.*x0*pow(x2-1.,-2.5);
            case 5:
                derivs[5]=105.*pow(x0,4)*pow(x2-1.,-4.5)-90.*x2*pow(x2-1.,-3.5)+9.*pow(x2-1.,-2.5);
            case 6:
                derivs[6]=-945.*pow(x0,5)*pow(x2-1.,-5.5)+1050.*pow(x0,3)*pow(x2-1.,-4.5)-225.*x0*pow(x2-1.,-3.5);
            case 7:
                derivs[7]=10395.*pow(x0,6)*pow(x2-1.,-6.5)-14175.*pow(x0,4)*pow(x2-1.,-5.5)+4725.*x2*pow(x2-1.,-4.5)-225.*pow(x2-1.,-3.5);
            case 8:
                derivs[8]=-135135.*pow(x0,7)*pow(x2-1.,-7.5)+218295.*pow(x0,5)*pow(x2-1.,-6.5)-99225.*pow(x0,3)*pow(x2-1.,-5.5)+11025.*x0*pow(x2-1.,-4.5);
            case 9:
                derivs[9]=2027025.*pow(x0,8)*pow(x2-1.,-8.5)-3783780.*pow(x0,6)*pow(x2-1.,-7.5)+2182950.*pow(x0,4)*pow(x2-1.,-6.5)-396900.*x2*pow(x2-1.,-5.5)+11025.*pow(x2-1.,-4.5);
            case 10:
                derivs[10]=-34459425.*pow(x0,9)*pow(x2-1.,-9.5)+72972900.*pow(x0,7)*pow(x2-1.,-8.5)-51081030.*pow(x0,5)*pow(x2-1.,-7.5)+13097700.*pow(x0,3)*pow(x2-1.,-6.5)-893025.*x0*pow(x2-1.,-5.5);
        }
    }
}
// ----------------------------------------------------------------------------------------------------

// ****************************************************************************************************
void der_r_atanh(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t x2 = pow(x0,2);
    derivs[0]=atanh(x0);
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=1./(1.-x2);
            case 2:
                derivs[2]=2.*x0/pow(1.-x2,2);
            case 3:
                derivs[3]=8.*x2/pow(1.-x2,3)+2./pow(1.-x2,2);
            case 4:
                derivs[4]=48.*pow(x0,3)/pow(1.-x2,4)+24.*x0/pow(1.-x2,3);
            case 5:
                derivs[5]=384.*pow(x0,4)/pow(1.-x2,5)+288.*x2/pow(1.-x2,4)+24./pow(1.-x2,3);
            case 6:
                derivs[6]=3840.*pow(x0,5)/pow(1.-x2,6)+3840.*pow(x0,3)/pow(1.-x2,5)+720.*x0/pow(1.-x2,4);
            case 7:
                derivs[7]=46080.*pow(x0,6)/pow(1.-x2,7)+57600.*pow(x0,4)/pow(1.-x2,6)+17280.*x2/pow(1.-x2,5)+720./pow(1.-x2,4);
            case 8:
                derivs[8]=645120.*pow(x0,7)/pow(1.-x2,8)+967680.*pow(x0,5)/pow(1.-x2,7)+403200.*pow(x0,3)/pow(1.-x2,6)+40320.*x0/pow(1.-x2,5);
            case 9:
                derivs[9]=10321920.*pow(x0,8)/pow(1.-x2,9)+18063360.*pow(x0,6)/pow(1.-x2,8)+9676800.*pow(x0,4)/pow(1.-x2,7)+1612800.*x2/pow(1.-x2,6)+40320./pow(1.-x2,5);
            case 10:
                derivs[10]=185794560.*pow(x0,9)/pow(1.-x2,10)+371589120.*pow(x0,7)/pow(1.-x2,9)+243855360.*pow(x0,5)/pow(1.-x2,8)+58060800.*pow(x0,3)/pow(1.-x2,7)+3628800.*x0/pow(1.-x2,6);
        }
    }
}
// ----------------------------------------------------------------------------------------------------

// ****************************************************************************************************
void der_r_tan(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t tx = tan(x0);
    coeff_t tx2 = pow(tx,2);
    derivs[0]=tx;
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=tx2+1.0;
            case 2:
                derivs[2]=(2.*tx2+2.)*tx;
            case 3:
                derivs[3]=(tx2+1.)*(2.*tx2+2.)+2.*(2.*tx2+2.)*tx2;
            case 4:
                derivs[4]=2.*(tx2+1.)*(2.*tx2+2.)*tx+3.*pow(2.*tx2+2.,2)*tx+4.*(2.*tx2+2.)*pow(tx,3);
            case 5:
                derivs[5]=4.*(tx2+1.)*pow(2.*tx2+2.,2)+16.*pow(2.*tx2+2.,2)*tx2+4.*(2.*tx2+2.)*(3.*tx2+3.)*tx2+8.*(2.*tx2+2.)*pow(tx,4);
            case 6:
                derivs[6]=16.*(tx2+1.)*pow(2.*tx2+2.,2)*tx+20.*pow(2.*tx2+2.,3)*tx+4.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*tx+76.*pow(2.*tx2+2.,2)*pow(tx,3)+8.*(2.*tx2+2.)*(3.*tx2+3.)*pow(tx,3)+8.*(2.*tx2+2.)*(4.*tx2+4.)*pow(tx,3)+16.*(2.*tx2+2.)*pow(tx,5);
            case 7:
                derivs[7]=16.*pow(tx2+1.,2)*pow(2.*tx2+2.,2)+20.*(tx2+1.)*pow(2.*tx2+2.,3)+4.*(tx2+1.)*pow(2.*tx2+2.,2)*(3.*tx2+3.)+64.*(tx2+1.)*pow(2.*tx2+2.,2)*tx2+148.*pow(2.*tx2+2.,3)*tx2+92.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*tx2+360.*pow(2.*tx2+2.,2)*pow(tx,4)+8.*(2.*tx2+2.)*pow(3.*tx2+3.,2)*tx2+8.*(2.*tx2+2.)*(3.*tx2+3.)*(4.*tx2+4.)*tx2+16.*(2.*tx2+2.)*(3.*tx2+3.)*pow(tx,4)+16.*(2.*tx2+2.)*(4.*tx2+4.)*pow(tx,4)+16.*(2.*tx2+2.)*(5.*tx2+5.)*pow(tx,4)+32.*(2.*tx2+2.)*pow(tx,6);
            case 8:
                derivs[8]=64.*pow(tx2+1.,2)*pow(2.*tx2+2.,2)*tx+228.*(tx2+1.)*pow(2.*tx2+2.,3)*tx+16.*(tx2+1.)*pow(2.*tx2+2.,2)*(3.*tx2+3.)*tx+256.*(tx2+1.)*pow(2.*tx2+2.,2)*pow(tx,3)+168.*pow(2.*tx2+2.,4)*tx+96.*pow(2.*tx2+2.,3)*(3.*tx2+3.)*tx+1228.*pow(2.*tx2+2.,3)*pow(tx,3)+8.*pow(2.*tx2+2.,2)*pow(3.*tx2+3.,2)*tx+8.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*(4.*tx2+4.)*tx+448.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*pow(tx,3)+384.*pow(2.*tx2+2.,2)*(4.*tx2+4.)*pow(tx,3)+1632.*pow(2.*tx2+2.,2)*pow(tx,5)+16.*(2.*tx2+2.)*pow(3.*tx2+3.,2)*pow(tx,3)+32.*(2.*tx2+2.)*(3.*tx2+3.)*(4.*tx2+4.)*pow(tx,3)+32.*(2.*tx2+2.)*(3.*tx2+3.)*pow(tx,5)+16.*(2.*tx2+2.)*pow(4.*tx2+4.,2)*pow(tx,3)+16.*(2.*tx2+2.)*(4.*tx2+4.)*(5.*tx2+5.)*pow(tx,3)+32.*(2.*tx2+2.)*(4.*tx2+4.)*pow(tx,5)+32.*(2.*tx2+2.)*(5.*tx2+5.)*pow(tx,5)+32.*(2.*tx2+2.)*(6.*tx2+6.)*pow(tx,5)+64.*(2.*tx2+2.)*pow(tx,7);
            case 9:
                derivs[9]=64.*pow(tx2+1.,3)*pow(2.*tx2+2.,2)+228.*pow(tx2+1.,2)*pow(2.*tx2+2.,3)+16.*pow(tx2+1.,2)*pow(2.*tx2+2.,2)*(3.*tx2+3.)+256.*pow(tx2+1.,2)*pow(2.*tx2+2.,2)*tx2+168.*(tx2+1.)*pow(2.*tx2+2.,4)+96.*(tx2+1.)*pow(2.*tx2+2.,3)*(3.*tx2+3.)+1544.*(tx2+1.)*pow(2.*tx2+2.,3)*tx2+8.*(tx2+1.)*pow(2.*tx2+2.,2)*pow(3.*tx2+3.,2)+8.*(tx2+1.)*pow(2.*tx2+2.,2)*(3.*tx2+3.)*(4.*tx2+4.)+320.*(tx2+1.)*pow(2.*tx2+2.,2)*(3.*tx2+3.)*tx2+1024.*(tx2+1.)*pow(2.*tx2+2.,2)*pow(tx,4)+1860.*pow(2.*tx2+2.,4)*tx2+1900.*pow(2.*tx2+2.,3)*(3.*tx2+3.)*tx2+24.*pow(2.*tx2+2.,3)*(4.*tx2+4.)*tx2+10504.*pow(2.*tx2+2.,3)*pow(tx,4)+480.*pow(2.*tx2+2.,2)*pow(3.*tx2+3.,2)*tx2+416.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*(4.*tx2+4.)*tx2+2016.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*pow(tx,4)+1840.*pow(2.*tx2+2.,2)*(4.*tx2+4.)*pow(tx,4)+1696.*pow(2.*tx2+2.,2)*(5.*tx2+5.)*pow(tx,4)+7104.*pow(2.*tx2+2.,2)*pow(tx,6)+16.*(2.*tx2+2.)*pow(3.*tx2+3.,3)*tx2+32.*(2.*tx2+2.)*pow(3.*tx2+3.,2)*(4.*tx2+4.)*tx2+32.*(2.*tx2+2.)*pow(3.*tx2+3.,2)*pow(tx,4)+16.*(2.*tx2+2.)*(3.*tx2+3.)*pow(4.*tx2+4.,2)*tx2+16.*(2.*tx2+2.)*(3.*tx2+3.)*(4.*tx2+4.)*(5.*tx2+5.)*tx2+64.*(2.*tx2+2.)*(3.*tx2+3.)*(4.*tx2+4.)*pow(tx,4)+32.*(2.*tx2+2.)*(3.*tx2+3.)*(5.*tx2+5.)*pow(tx,4)+64.*(2.*tx2+2.)*(3.*tx2+3.)*pow(tx,6)+32.*(2.*tx2+2.)*pow(4.*tx2+4.,2)*pow(tx,4)+64.*(2.*tx2+2.)*(4.*tx2+4.)*(5.*tx2+5.)*pow(tx,4)+64.*(2.*tx2+2.)*(4.*tx2+4.)*pow(tx,6)+32.*(2.*tx2+2.)*pow(5.*tx2+5.,2)*pow(tx,4)+32.*(2.*tx2+2.)*(5.*tx2+5.)*(6.*tx2+6.)*pow(tx,4)+64.*(2.*tx2+2.)*(5.*tx2+5.)*pow(tx,6)+64.*(2.*tx2+2.)*(6.*tx2+6.)*pow(tx,6)+64.*(2.*tx2+2.)*(7.*tx2+7.)*pow(tx,6)+128.*(2.*tx2+2.)*pow(tx,8);
            case 10:
                derivs[10]=256.*pow(tx2+1.,3)*pow(2.*tx2+2.,2)*tx+1864.*pow(tx2+1.,2)*pow(2.*tx2+2.,3)*tx+64.*pow(tx2+1.,2)*pow(2.*tx2+2.,2)*(3.*tx2+3.)*tx+1024.*pow(tx2+1.,2)*pow(2.*tx2+2.,2)*pow(tx,3)+3632.*(tx2+1.)*pow(2.*tx2+2.,4)*tx+1008.*(tx2+1.)*pow(2.*tx2+2.,3)*(3.*tx2+3.)*tx+24.*(tx2+1.)*pow(2.*tx2+2.,3)*(4.*tx2+4.)*tx+10736.*(tx2+1.)*pow(2.*tx2+2.,3)*pow(tx,3)+32.*(tx2+1.)*pow(2.*tx2+2.,2)*pow(3.*tx2+3.,2)*tx+32.*(tx2+1.)*pow(2.*tx2+2.,2)*(3.*tx2+3.)*(4.*tx2+4.)*tx+1280.*(tx2+1.)*pow(2.*tx2+2.,2)*(3.*tx2+3.)*pow(tx,3)+1024.*(tx2+1.)*pow(2.*tx2+2.,2)*(4.*tx2+4.)*pow(tx,3)+4096.*(tx2+1.)*pow(2.*tx2+2.,2)*pow(tx,5)+2028.*pow(2.*tx2+2.,5)*tx+1996.*pow(2.*tx2+2.,4)*(3.*tx2+3.)*tx+24.*pow(2.*tx2+2.,4)*(4.*tx2+4.)*tx+22220.*pow(2.*tx2+2.,4)*pow(tx,3)+488.*pow(2.*tx2+2.,3)*pow(3.*tx2+3.,2)*tx+424.*pow(2.*tx2+2.,3)*(3.*tx2+3.)*(4.*tx2+4.)*tx+16264.*pow(2.*tx2+2.,3)*(3.*tx2+3.)*pow(tx,3)+11896.*pow(2.*tx2+2.,3)*(4.*tx2+4.)*pow(tx,3)+85936.*pow(2.*tx2+2.,3)*pow(tx,5)+16.*pow(2.*tx2+2.,2)*pow(3.*tx2+3.,3)*tx+32.*pow(2.*tx2+2.,2)*pow(3.*tx2+3.,2)*(4.*tx2+4.)*tx+2192.*pow(2.*tx2+2.,2)*pow(3.*tx2+3.,2)*pow(tx,3)+16.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*pow(4.*tx2+4.,2)*tx+16.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*(4.*tx2+4.)*(5.*tx2+5.)*tx+4080.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*(4.*tx2+4.)*pow(tx,3)+64.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*(5.*tx2+5.)*pow(tx,3)+8672.*pow(2.*tx2+2.,2)*(3.*tx2+3.)*pow(tx,5)+1888.*pow(2.*tx2+2.,2)*pow(4.*tx2+4.,2)*pow(tx,3)+1744.*pow(2.*tx2+2.,2)*(4.*tx2+4.)*(5.*tx2+5.)*pow(tx,3)+8128.*pow(2.*tx2+2.,2)*(4.*tx2+4.)*pow(tx,5)+7648.*pow(2.*tx2+2.,2)*(5.*tx2+5.)*pow(tx,5)+7264.*pow(2.*tx2+2.,2)*(6.*tx2+6.)*pow(tx,5)+30016.*pow(2.*tx2+2.,2)*pow(tx,7)+32.*(2.*tx2+2.)*pow(3.*tx2+3.,3)*pow(tx,3)+96.*(2.*tx2+2.)*pow(3.*tx2+3.,2)*(4.*tx2+4.)*pow(tx,3)+64.*(2.*tx2+2.)*pow(3.*tx2+3.,2)*pow(tx,5)+96.*(2.*tx2+2.)*(3.*tx2+3.)*pow(4.*tx2+4.,2)*pow(tx,3)+64.*(2.*tx2+2.)*(3.*tx2+3.)*(4.*tx2+4.)*(5.*tx2+5.)*pow(tx,3)+128.*(2.*tx2+2.)*(3.*tx2+3.)*(4.*tx2+4.)*pow(tx,5)+64.*(2.*tx2+2.)*(3.*tx2+3.)*(5.*tx2+5.)*pow(tx,5)+64.*(2.*tx2+2.)*(3.*tx2+3.)*(6.*tx2+6.)*pow(tx,5)+128.*(2.*tx2+2.)*(3.*tx2+3.)*pow(tx,7)+32.*(2.*tx2+2.)*pow(4.*tx2+4.,3)*pow(tx,3)+64.*(2.*tx2+2.)*pow(4.*tx2+4.,2)*(5.*tx2+5.)*pow(tx,3)+64.*(2.*tx2+2.)*pow(4.*tx2+4.,2)*pow(tx,5)+32.*(2.*tx2+2.)*(4.*tx2+4.)*pow(5.*tx2+5.,2)*pow(tx,3)+32.*(2.*tx2+2.)*(4.*tx2+4.)*(5.*tx2+5.)*(6.*tx2+6.)*pow(tx,3)+128.*(2.*tx2+2.)*(4.*tx2+4.)*(5.*tx2+5.)*pow(tx,5)+64.*(2.*tx2+2.)*(4.*tx2+4.)*(6.*tx2+6.)*pow(tx,5)+128.*(2.*tx2+2.)*(4.*tx2+4.)*pow(tx,7)+64.*(2.*tx2+2.)*pow(5.*tx2+5.,2)*pow(tx,5)+128.*(2.*tx2+2.)*(5.*tx2+5.)*(6.*tx2+6.)*pow(tx,5)+128.*(2.*tx2+2.)*(5.*tx2+5.)*pow(tx,7)+64.*(2.*tx2+2.)*pow(6.*tx2+6.,2)*pow(tx,5)+64.*(2.*tx2+2.)*(6.*tx2+6.)*(7.*tx2+7.)*pow(tx,5)+128.*(2.*tx2+2.)*(6.*tx2+6.)*pow(tx,7)+128.*(2.*tx2+2.)*(7.*tx2+7.)*pow(tx,7)+128.*(2.*tx2+2.)*(8.*tx2+8.)*pow(tx,7)+256.*(2.*tx2+2.)*pow(tx,9);
        }
    }
}
// ----------------------------------------------------------------------------------------------------

// ****************************************************************************************************
void der_r_tanh(coeff_t x0, ord_t order, coeff_t* derivs){

    ord_t i;
    coeff_t tx = tanh(x0);
    coeff_t tx2 = pow(tx,2);
    derivs[0]=tx;
    for(i=1;i<=order;i++){
        switch(i){
            case 1:
                derivs[1]=1.-tx2;
            case 2:
                derivs[2]=-(2.-2.*tx2)*tx;
            case 3:
                derivs[3]=(1.-tx2)*(2.*tx2-2.)+2.*(2.-2.*tx2)*tx2;
            case 4:
                derivs[4]=2.*(1.-tx2)*(2.-2.*tx2)*tx+2.*pow(2.-2.*tx2,2)*tx-(2.-2.*tx2)*(2.*tx2-2.)*tx-4.*(2.-2.*tx2)*pow(tx,3);
            case 5:
                derivs[5]=4.*(1.-tx2)*pow(2.-2.*tx2,2)-16.*pow(2.-2.*tx2,2)*tx2-4.*(2.-2.*tx2)*(3.-3.*tx2)*tx2+8.*(2.-2.*tx2)*pow(tx,4);
            case 6:
                derivs[6]=-16.*(1.-tx2)*pow(2.-2.*tx2,2)*tx-20.*pow(2.-2.*tx2,3)*tx-4.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*tx+76.*pow(2.-2.*tx2,2)*pow(tx,3)+8.*(2.-2.*tx2)*(3.-3.*tx2)*pow(tx,3)+8.*(2.-2.*tx2)*(4.-4.*tx2)*pow(tx,3)-16.*(2.-2.*tx2)*pow(tx,5);
            case 7:
                derivs[7]=-16.*pow(1.-tx2,2)*pow(2.-2.*tx2,2)-20.*(1.-tx2)*pow(2.-2.*tx2,3)-4.*(1.-tx2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)+64.*(1.-tx2)*pow(2.-2.*tx2,2)*tx2+148.*pow(2.-2.*tx2,3)*tx2+92.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*tx2-360.*pow(2.-2.*tx2,2)*pow(tx,4)+8.*(2.-2.*tx2)*pow(3.-3.*tx2,2)*tx2+8.*(2.-2.*tx2)*(3.-3.*tx2)*(4.-4.*tx2)*tx2-16.*(2.-2.*tx2)*(3.-3.*tx2)*pow(tx,4)-16.*(2.-2.*tx2)*(4.-4.*tx2)*pow(tx,4)-16.*(2.-2.*tx2)*(5.-5.*tx2)*pow(tx,4)+32.*(2.-2.*tx2)*pow(tx,6);
            case 8:
                derivs[8]=64.*pow(1.-tx2,2)*pow(2.-2.*tx2,2)*tx+228.*(1.-tx2)*pow(2.-2.*tx2,3)*tx+16.*(1.-tx2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)*tx-256.*(1.-tx2)*pow(2.-2.*tx2,2)*pow(tx,3)+168.*pow(2.-2.*tx2,4)*tx+96.*pow(2.-2.*tx2,3)*(3.-3.*tx2)*tx-1228.*pow(2.-2.*tx2,3)*pow(tx,3)+8.*pow(2.-2.*tx2,2)*pow(3.-3.*tx2,2)*tx+8.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*(4.-4.*tx2)*tx-448.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*pow(tx,3)-384.*pow(2.-2.*tx2,2)*(4.-4.*tx2)*pow(tx,3)+1632.*pow(2.-2.*tx2,2)*pow(tx,5)-16.*(2.-2.*tx2)*pow(3.-3.*tx2,2)*pow(tx,3)-32.*(2.-2.*tx2)*(3.-3.*tx2)*(4.-4.*tx2)*pow(tx,3)+32.*(2.-2.*tx2)*(3.-3.*tx2)*pow(tx,5)-16.*(2.-2.*tx2)*pow(4.-4.*tx2,2)*pow(tx,3)-16.*(2.-2.*tx2)*(4.-4.*tx2)*(5.-5.*tx2)*pow(tx,3)+32.*(2.-2.*tx2)*(4.-4.*tx2)*pow(tx,5)+32.*(2.-2.*tx2)*(5.-5.*tx2)*pow(tx,5)+32.*(2.-2.*tx2)*(6.-6.*tx2)*pow(tx,5)-64.*(2.-2.*tx2)*pow(tx,7);
            case 9:
                derivs[9]=64.*pow(1.-tx2,3)*pow(2.-2.*tx2,2)+228.*pow(1.-tx2,2)*pow(2.-2.*tx2,3)+16.*pow(1.-tx2,2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)-256.*pow(1.-tx2,2)*pow(2.-2.*tx2,2)*tx2+168.*(1.-tx2)*pow(2.-2.*tx2,4)+96.*(1.-tx2)*pow(2.-2.*tx2,3)*(3.-3.*tx2)-1544.*(1.-tx2)*pow(2.-2.*tx2,3)*tx2+8.*(1.-tx2)*pow(2.-2.*tx2,2)*pow(3.-3.*tx2,2)+8.*(1.-tx2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)*(4.-4.*tx2)-320.*(1.-tx2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)*tx2+1024.*(1.-tx2)*pow(2.-2.*tx2,2)*pow(tx,4)-1860.*pow(2.-2.*tx2,4)*tx2-1900.*pow(2.-2.*tx2,3)*(3.-3.*tx2)*tx2-24.*pow(2.-2.*tx2,3)*(4.-4.*tx2)*tx2+10504.*pow(2.-2.*tx2,3)*pow(tx,4)-480.*pow(2.-2.*tx2,2)*pow(3.-3.*tx2,2)*tx2-416.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*(4.-4.*tx2)*tx2+2016.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*pow(tx,4)+1840.*pow(2.-2.*tx2,2)*(4.-4.*tx2)*pow(tx,4)+1696.*pow(2.-2.*tx2,2)*(5.-5.*tx2)*pow(tx,4)-7104.*pow(2.-2.*tx2,2)*pow(tx,6)-16.*(2.-2.*tx2)*pow(3.-3.*tx2,3)*tx2-32.*(2.-2.*tx2)*pow(3.-3.*tx2,2)*(4.-4.*tx2)*tx2+32.*(2.-2.*tx2)*pow(3.-3.*tx2,2)*pow(tx,4)-16.*(2.-2.*tx2)*(3.-3.*tx2)*pow(4.-4.*tx2,2)*tx2-16.*(2.-2.*tx2)*(3.-3.*tx2)*(4.-4.*tx2)*(5.-5.*tx2)*tx2+64.*(2.-2.*tx2)*(3.-3.*tx2)*(4.-4.*tx2)*pow(tx,4)+32.*(2.-2.*tx2)*(3.-3.*tx2)*(5.-5.*tx2)*pow(tx,4)-64.*(2.-2.*tx2)*(3.-3.*tx2)*pow(tx,6)+32.*(2.-2.*tx2)*pow(4.-4.*tx2,2)*pow(tx,4)+64.*(2.-2.*tx2)*(4.-4.*tx2)*(5.-5.*tx2)*pow(tx,4)-64.*(2.-2.*tx2)*(4.-4.*tx2)*pow(tx,6)+32.*(2.-2.*tx2)*pow(5.-5.*tx2,2)*pow(tx,4)+32.*(2.-2.*tx2)*(5.-5.*tx2)*(6.-6.*tx2)*pow(tx,4)-64.*(2.-2.*tx2)*(5.-5.*tx2)*pow(tx,6)-64.*(2.-2.*tx2)*(6.-6.*tx2)*pow(tx,6)-64.*(2.-2.*tx2)*(7.-7.*tx2)*pow(tx,6)+128.*(2.-2.*tx2)*pow(tx,8);
            case 10:
                derivs[10]=-256.*pow(1.-tx2,3)*pow(2.-2.*tx2,2)*tx-1864.*pow(1.-tx2,2)*pow(2.-2.*tx2,3)*tx-64.*pow(1.-tx2,2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)*tx+1024.*pow(1.-tx2,2)*pow(2.-2.*tx2,2)*pow(tx,3)-3632.*(1.-tx2)*pow(2.-2.*tx2,4)*tx-1008.*(1.-tx2)*pow(2.-2.*tx2,3)*(3.-3.*tx2)*tx-24.*(1.-tx2)*pow(2.-2.*tx2,3)*(4.-4.*tx2)*tx+10736.*(1.-tx2)*pow(2.-2.*tx2,3)*pow(tx,3)-32.*(1.-tx2)*pow(2.-2.*tx2,2)*pow(3.-3.*tx2,2)*tx-32.*(1.-tx2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)*(4.-4.*tx2)*tx+1280.*(1.-tx2)*pow(2.-2.*tx2,2)*(3.-3.*tx2)*pow(tx,3)+1024.*(1.-tx2)*pow(2.-2.*tx2,2)*(4.-4.*tx2)*pow(tx,3)-4096.*(1.-tx2)*pow(2.-2.*tx2,2)*pow(tx,5)-2028.*pow(2.-2.*tx2,5)*tx-1996.*pow(2.-2.*tx2,4)*(3.-3.*tx2)*tx-24.*pow(2.-2.*tx2,4)*(4.-4.*tx2)*tx+22220.*pow(2.-2.*tx2,4)*pow(tx,3)-488.*pow(2.-2.*tx2,3)*pow(3.-3.*tx2,2)*tx-424.*pow(2.-2.*tx2,3)*(3.-3.*tx2)*(4.-4.*tx2)*tx+16264.*pow(2.-2.*tx2,3)*(3.-3.*tx2)*pow(tx,3)+11896.*pow(2.-2.*tx2,3)*(4.-4.*tx2)*pow(tx,3)-85936.*pow(2.-2.*tx2,3)*pow(tx,5)-16.*pow(2.-2.*tx2,2)*pow(3.-3.*tx2,3)*tx-32.*pow(2.-2.*tx2,2)*pow(3.-3.*tx2,2)*(4.-4.*tx2)*tx+2192.*pow(2.-2.*tx2,2)*pow(3.-3.*tx2,2)*pow(tx,3)-16.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*pow(4.-4.*tx2,2)*tx-16.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*(4.-4.*tx2)*(5.-5.*tx2)*tx+4080.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*(4.-4.*tx2)*pow(tx,3)+64.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*(5.-5.*tx2)*pow(tx,3)-8672.*pow(2.-2.*tx2,2)*(3.-3.*tx2)*pow(tx,5)+1888.*pow(2.-2.*tx2,2)*pow(4.-4.*tx2,2)*pow(tx,3)+1744.*pow(2.-2.*tx2,2)*(4.-4.*tx2)*(5.-5.*tx2)*pow(tx,3)-8128.*pow(2.-2.*tx2,2)*(4.-4.*tx2)*pow(tx,5)-7648.*pow(2.-2.*tx2,2)*(5.-5.*tx2)*pow(tx,5)-7264.*pow(2.-2.*tx2,2)*(6.-6.*tx2)*pow(tx,5)+30016.*pow(2.-2.*tx2,2)*pow(tx,7)+32.*(2.-2.*tx2)*pow(3.-3.*tx2,3)*pow(tx,3)+96.*(2.-2.*tx2)*pow(3.-3.*tx2,2)*(4.-4.*tx2)*pow(tx,3)-64.*(2.-2.*tx2)*pow(3.-3.*tx2,2)*pow(tx,5)+96.*(2.-2.*tx2)*(3.-3.*tx2)*pow(4.-4.*tx2,2)*pow(tx,3)+64.*(2.-2.*tx2)*(3.-3.*tx2)*(4.-4.*tx2)*(5.-5.*tx2)*pow(tx,3)-128.*(2.-2.*tx2)*(3.-3.*tx2)*(4.-4.*tx2)*pow(tx,5)-64.*(2.-2.*tx2)*(3.-3.*tx2)*(5.-5.*tx2)*pow(tx,5)-64.*(2.-2.*tx2)*(3.-3.*tx2)*(6.-6.*tx2)*pow(tx,5)+128.*(2.-2.*tx2)*(3.-3.*tx2)*pow(tx,7)+32.*(2.-2.*tx2)*pow(4.-4.*tx2,3)*pow(tx,3)+64.*(2.-2.*tx2)*pow(4.-4.*tx2,2)*(5.-5.*tx2)*pow(tx,3)-64.*(2.-2.*tx2)*pow(4.-4.*tx2,2)*pow(tx,5)+32.*(2.-2.*tx2)*(4.-4.*tx2)*pow(5.-5.*tx2,2)*pow(tx,3)+32.*(2.-2.*tx2)*(4.-4.*tx2)*(5.-5.*tx2)*(6.-6.*tx2)*pow(tx,3)-128.*(2.-2.*tx2)*(4.-4.*tx2)*(5.-5.*tx2)*pow(tx,5)-64.*(2.-2.*tx2)*(4.-4.*tx2)*(6.-6.*tx2)*pow(tx,5)+128.*(2.-2.*tx2)*(4.-4.*tx2)*pow(tx,7)-64.*(2.-2.*tx2)*pow(5.-5.*tx2,2)*pow(tx,5)-128.*(2.-2.*tx2)*(5.-5.*tx2)*(6.-6.*tx2)*pow(tx,5)+128.*(2.-2.*tx2)*(5.-5.*tx2)*pow(tx,7)-64.*(2.-2.*tx2)*pow(6.-6.*tx2,2)*pow(tx,5)-64.*(2.-2.*tx2)*(6.-6.*tx2)*(7.-7.*tx2)*pow(tx,5)+128.*(2.-2.*tx2)*(6.-6.*tx2)*pow(tx,7)+128.*(2.-2.*tx2)*(7.-7.*tx2)*pow(tx,7)+128.*(2.-2.*tx2)*(8.-8.*tx2)*pow(tx,7)-256.*(2.-2.*tx2)*pow(tx,9);
        }
    }
}
// ----------------------------------------------------------------------------------------------------
